<div class="container page">
  <div class="container">
    <div class="date-navigation">
        <% if params[:date] %>
          <%= link_to day_path(date: (params[:date].to_date - 1)) do %>
            <i class="fas fa-arrow-left"> </i>
          <% end %>
          <h1 class="date-today mt-3"><%= params[:date].to_date.strftime("%b %d") %>, <%= Time.now.strftime("%H:%M") %></h1>
          <%= link_to day_path(date: (params[:date].to_date + 1)) do %>
            <i class="fas fa-arrow-right"> </i>
          <% end %>
        <% end %>
         </div>
        <% moon_today = Moon.where(date: params[:date], location: current_user.location.delete(' ')).first %>
      <div class="Title-location"> <p><%= moon_today.display_location %></p></div>
    <!-- Fetch daily horoscope -->
    <div class="info-card my-3 mx-2">
      <p>
        <% moon_today = Moon.where(date: params[:date], location: current_user.location.delete(' ')).first %>
        <% if moon_today.date.to_date == Date.today %>
          <p><%= @daily_horoscope %></p>
        <% elsif moon_today.date.to_date == Date.today - 1.day %>
          <p><%= @yesterday_horoscope %></p>
        <% elsif moon_today.date.to_date == Date.today + 1.day %>
          <p><%= @tomorrow_horoscope %></p>
        <% elsif moon_today.date.to_date < Date.today %>
          <p>✨ Let the past be the past. This day has come and gone. What has been is what had to be. What has not been, was never meant to be. ✨</p>
        <% elsif moon_today.date.to_date > Date.today %>
          <p>✨ Don't get too caught up in the future. The time is now and it's advisable to live in the present moment. Come back on <%= (moon_today.date - 1.day).strftime("%B %d") %> at the earliest to see your horoscope for this day. ✨</p>
        <% end %>
      </p>
    </div>
  </div>

  <div class="container moon-data mt-3">
    <% moon_today = Moon.where(date: params[:date], location: current_user.location.delete(' ')).first %>
    <%= image_tag moon_today.moon_phase_img, class: "moon-image", width: "100px" %>
    <% if moon_today.moonrise %>
      <div class="title-moonrise"> <h4>Moonrise</h4> <p><%= moon_today.moonrise.strftime("%H:%M %Z") %></p></div>
    <% else %>
      <div class="title-moonrise"> <h4>Moonrise</h4> <p>No moonrise today</p></div>
    <% end %>
      <% if moon_today.moonset %>
      <div class="title-moonset"> <h4>Moonset</h4> <p><%= moon_today.moonset.strftime("%H:%M %Z")%></p></div>
    <% else %>
      <div class="title-moonset"> <h4>Moonset</h4> <p>No moonset today</p></div>
    <% end %>
    <div class="title-moonphase"> <h4>Moonphase</h4><p> <%= moon_today.moon_phase_name %></p></div>
      <div class="title-moon-sign"> <h4>Moon Sign</h4> <p><%= moon_today.moon_sign %></div>
  </div>

  <!-- Tabs -->
  <div class="tab-day"><%= render "tabs" %></div>
   <div class="container navigation day-nav my-3">
        <%= link_to "Day", day_path(:date => Date.today), class:"btn btn-dark day-page-btn" %>
        <%= link_to "Month", month_path(:date => params[:date]), class:"btn btn-dark day-page-month-btn " %>
        <%= link_to "Stats", stats_path, class:"btn btn-dark day-page-stats-btn" %>
      </div>
</div>
